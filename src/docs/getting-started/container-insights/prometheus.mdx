---
title: 'Container Insights Prometheus'
description:
    CloudWatch Container Insights Prometheus supports saving and visualizing Prometheus metrics with pre-built CloudWatch dashboards.
    Auto discovery works out of box on ECS and EKS using both EC2 and Fargate.
path: '/docs/getting-started/container-insights/prometheus'
---

import SectionSeparator from "components/MdxSectionSeparator/sectionSeparator.jsx"
import {Link} from "gatsby"

<!-- Poor man's breadcrumb -->

<p>
    GettingStarted / <Link to="/docs/getting-started/container-insights">Container Insights</Link>
</p>

<SectionSeparator/>

CloudWatch Container Insights supports saving and visualizing [Prometheus metrics](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/ContainerInsights-Prometheus.html).
ADOT collector uses Prometheus Receiver and CloudWatch EMF Exporter to offer same experience as existing [CloudWatch Agent](https://github.com/aws/amazon-cloudwatch-agent).

## See Also

- [Container Insights EKS Prometheus](eks-prometheus)
- [Container Insights ECS Prometheus](ecs-prometheus)
- [Container Insights Prometheus Official Doc](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/ContainerInsights-Prometheus.html)

## Supported environments

Similar to [CloudWatch Agent](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/ContainerInsights-Prometheus.html),
both EKS and ECS are supported using the following components.
ECS requires extension because Prometheus does not have builtin disocvery for ECS (unlike EKS).

| Environment           | Extension    | Receiver   | Exporter       |
|-----------------------|--------------|------------|----------------|
| [EKS](eks-prometheus) | N/A          | Prometheus | CloudWatch EMF |
| [ECS](ecs-prometheus) | ECS Observer | Prometheus | CloudWatch EMF |

## Pre-built dashboards for worklods

CloudWatch console has auto dashboard for workloads listed in following table.

| Environment           | AWS App Mesh | Java JMX | NGINX | NGINX Plus | HAProxy | Memcached |
|-----------------------|--------------|----------|-------|------------|---------|-----------|
| [EKS](eks-prometheus) | Y            | Y        | Y     | N          | Y       | Y         |
| [ECS](ecs-prometheus) | Y            | Y        | Y     | Y          | N       | N         |

- Workload without pre-build dashboard can still send metrics to CloudWatch. However, you need to [build your CloudWatch dashboard manually](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/create_dashboard.html).
<!-- - items in table link to workload setup instruction. -->

## Export format

Container Insights Prometheus are exported as both log and metrics.
EMF exporter matches metrics based on `metrics_selection` configuration to add extra metadata in structured log.
CloudWatch will extract EMF log to metric automatically and charge accordingly.
You can turn off metric extraction entirely and send all Prometheus metrics as structured log.

Assuming you have a EKS cluster called `eks-1` and a ECS cluster called `ecs-1`.
You will see the following resources in CloudWatch console.
Log group name contains cluster name while Metrics save all clusters under one namespace with different dimension value.

| Environment           | Log group                                     | Metrics Namespace                  |
|-----------------------|-----------------------------------------------|------------------------------------|
| [EKS](eks-prometheus) | `/aws/containerinsights/eks-1/prometheus`     | `ContainerInsights/Prometheus`     |
| [ECS](ecs-prometheus) | `/aws/ecs/containerinsights/ecs-1/prometheus` | `ECS/ContainerInsights/Prometheus` |

