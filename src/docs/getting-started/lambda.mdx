---
title: 'AWS Distro for OpenTelemetry Lambda'
description: The AWS Distro for OpenTelemetry now offers AWS Distro for OpenTelemetry Lambda layers with Application Signals support,
    providing a complete Application Performance Monitoring (APM) experience. These optimized ADOT Lambda layers deliver
    a plug-and-play user experience by automatically instrumenting Lambda functions without requiring a dedicated collector.
    The layers package OpenTelemetry with out-of-the-box configuration for AWS Lambda and AWS X-Ray, enabling simple setup
    through a convenient layer. Customers can easily enable or disable OpenTelemetry instrumentation for their Lambda
    functions without modifying any code, streamlining the observability implementation process.
path: '/docs/getting-started/lambda'
---

import SectionSeparator from "components/MdxSectionSeparator/sectionSeparator.jsx"
import AnnouncementBanner from "components/AnnouncementBanner/AnnouncementBanner.jsx"
import TipBox from "components/TipBox/TipBox.jsx"
import InfoBox from "components/InfoBox/InfoBox.jsx"
import TabbedTable from "components/TabbedTable/TabbedTable.jsx"
import WarningBox from "components/WarningBox/WarningBox.jsx"
import { lambdaLayerArnsConfig } from "config/lambdaLayerArns.js"
import { supportedRuntimesConfig } from "config/supportedRuntimes.js"

<AnnouncementBanner
  textContent="New: ADOT Lambda layers now support Application Signals for enhanced observability and monitoring capabilities."
  buttonText="Learn More"
  hyperlink="https://docs.aws.amazon.com/lambda/latest/dg/monitoring-application-signals.html"
/>

The AWS Distro for OpenTelemetry (ADOT) now offers AWS Distro for OpenTelemetry (ADOT) Lambda layers with Application Signals support,
    providing a complete Application Performance Monitoring (APM) experience. These optimized ADOT Lambda layers deliver
    a plug-and-play user experience by automatically instrumenting Lambda functions without requiring a dedicated collector.
    The layers package OpenTelemetry with out-of-the-box configuration for AWS Lambda and AWS X-Ray, enabling simple setup
    through a convenient layer. Customers can easily enable or disable OpenTelemetry instrumentation for their Lambda
    functions without modifying any code, streamlining the observability implementation process.

<TipBox
  textContent="Enable transaction search to capture 100% of Lambda traces - Reduce observability costs and time spent troubleshooting production issues through efficient, complete data collection"
  buttonText="Learn More"
  hyperlink="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch-Transaction-Search.html"
/>

<SectionSeparator />

## Getting Started with AWS Lambda layers

There are various methods for enabling AWS Distro for OpenTelemetry (ADOT) auto-instrumentation for your Lambda function

- Use the Lambda console
- Use the CloudWatch Application Signals console
- Using AWS CDK
- By manually adding the ADOT Lambda Layers

<InfoBox
  textContent="Following steps will also enable AWS Application Signals along with tracing in your Lambda function. If you want to disable AWS Application Signals and retain only tracing functionality, set the environment variable
  ```
  OTEL_AWS_APPLICATION_SIGNALS_ENABLED = false
  ```
  Note: We recommend to keep the AWS Application Signals turned on for the complete APM experience"
/>

<SectionSeparator />

## Use the Lambda Console

Use these steps to enable AWS Distro for OpenTelemetry (ADOT) auto-instrumentation through the Lambda console:

1. Open the AWS Lambda console at [https://console.aws.amazon.com/lambda/](https://console.aws.amazon.com/lambda/)
2. In the navigation pane, choose **Functions** and then choose the name of the function that you want to enable
3. Choose the **Configuration** tab, and then choose **Monitoring and operations tools**
4. Choose **Edit**
5. In the **CloudWatch Application Signals and X-Ray** section, select both:
   - **Automatically collect application traces and standard application metrics with Application Signals**
   - **Automatically collect Lambda service traces for end to end visibility with X-Ray**
6. Choose **Save**

<SectionSeparator />

## Use the CloudWatch Application Signals Console

Use these steps to enable AWS Distro for OpenTelemetry (ADOT) auto-instrumentation through the CloudWatch console:

1. Open the CloudWatch console at [https://console.aws.amazon.com/cloudwatch/](https://console.aws.amazon.com/cloudwatch/)
2. In the navigation pane, choose **Application Signals**, **Services**
3. In the **Services** list area, choose **Enable Application Signals**
4. Choose the **Lambda** tile
5. Select each function that you want to enable for Application Signals, and then choose **Done**

<SectionSeparator />

## Use the AWS CDK

### 1. Add the IAM policy.

```typescript
const fn = new Function(this, 'DemoFunction', {
    code: Code.fromAsset('$YOUR_LAMBDA.zip'),
    runtime: Runtime.PYTHON_3_12,
    handler: '$YOUR_HANDLER'
})

fn.role?.addManagedPolicy(ManagedPolicy.fromAwsManagedPolicyName(
    'CloudWatchLambdaApplicationSignalsExecutionRolePolicy'));
```

### 2. Add AWS Distro for OpenTelemetry (ADOT) Layer

```typescript
fn.addLayers(LayerVersion.fromLayerVersionArn(
    this, 'AwsLambdaLayerForOtel',
    '$AWS_LAMBDA_LAYER_FOR_OTEL_ARN'
))
fn.addEnvironment("AWS_LAMBDA_EXEC_WRAPPER", "/opt/otel-instrument");
// [Optional] Disable AWS Application Signals
// Recommended to keep the AWS Application Signals turned on for the complete APM experience
// fn.addEnvironment("OTEL_AWS_APPLICATION_SIGNALS_ENABLED", "false");
```

Replace `$AWS_LAMBDA_LAYER_FOR_OTEL_ARN` with the actual [AWS Lambda Layer for OpenTelemetry ARN in the corresponding region and language](#adot-lambda-layer-arns).

### (Optional) Enable Application Signals Discovery

If you have enabled Application Signals (recommended), you must grant Application Signals the permissions it needs to discover your services. For more information, see [Enable Application Signals in your account](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch-Application-Signals-Enable.html).

```typescript
import { aws_applicationsignals as applicationsignals } from 'aws-cdk-lib';

const cfnDiscovery = new applicationsignals.CfnDiscovery(this,
  'ApplicationSignalsServiceRole', { } );
```
The Discovery CloudFormation resource grants Application Signals the following permissions:

```
xray:GetServiceGraph
logs:StartQuery
logs:GetQueryResults
cloudwatch:GetMetricData
cloudwatch:ListMetrics
tag:GetResources
```

For more information about this role, see [Service-linked role permissions for CloudWatch Application Signals](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/using-service-linked-roles.html#service-linked-role-signals).

<SectionSeparator />

## Manually add ADOT Lambda Layers

1. **Add the ADOT Lambda Layer** to your Lambda runtime. Find the layer ARN for your region in the [Lambda Layer ARNs section](#adot-lambda-layer-arns) below.

2. **Set Environment Variables:**
   - `AWS_LAMBDA_EXEC_WRAPPER=/opt/otel-instrument`
   - (optional) `LAMBDA_APPLICATION_SIGNALS_REMOTE_ENVIRONMENT` - Configure custom Lambda environments. Default is `lambda:default`
   - (optional) `OTEL_AWS_APPLICATION_SIGNALS_ENABLED=false` - To disable AWS Application Signals.

3. **Attach IAM Policy** - Add the AWS managed IAM policy `CloudWatchLambdaApplicationSignalsExecutionRolePolicy` to the Lambda execution role.

4. **Enable Active Tracing** (Optional but recommended) - Enable Lambda active tracing to get a better tracing experience.

<SectionSeparator />

## Manually Remove AWS Distro for OpenTelemetry (ADOT) Lambda Layer
To manually disable Application Signals for a Lambda function, remove the AWS Lambda Layer for OpenTelemetry from your Lambda runtime, and remove the `AWS_LAMBDA_EXEC_WRAPPER=/opt/otel-instrument` environment variable.

<SectionSeparator />


## Configuration Options

### Sampling Configuration

By default, the trace sampling strategy is parent-based. You can adjust sampling by setting `OTEL_TRACES_SAMPLER`:

For example, in order to set trace sampling rate to 30%.

```
OTEL_TRACES_SAMPLER=traceidratio
OTEL_TRACES_SAMPLER_ARG=0.3
```

For more information , see [OpenTelemetry Environment Variable Specification](https://opentelemetry.io/docs/specs/otel/configuration/sdk-environment-variables/).

### Enable All Library Instrumentations

To reduce Lambda cold starts, by default only AWS SDK and HTTP instrumentations are enabled. Enable all instrumentations with:

- **Python:** `OTEL_PYTHON_DISABLED_INSTRUMENTATIONS=none`
- **Node.js:** `OTEL_NODE_DISABLED_INSTRUMENTATIONS=none`
- **Java:** `OTEL_INSTRUMENTATION_COMMON_DEFAULT_ENABLED=true`

### Service Grouping

Set the `OTEL_SERVICE_NAME` environment variable to group multiple Lambda functions into one service. This name will be displayed in Application Signals dashboards. Functions with the same service name will be merged into a single service.

<SectionSeparator />

## Supported Runtimes

The AWS Distro for OpenTelemetry (ADOT) Lambda Layer supports following runtimes:

<TabbedTable config={supportedRuntimesConfig} />

<SectionSeparator />

## ADOT Lambda Layer ARNs

### AWS Lambda Layer for OpenTelemetry ARNs

The following tables list the ARNs to use the AWS Lambda Layer for OpenTelemetry for each Region where it's supported.

<TabbedTable config={lambdaLayerArnsConfig} />

<SectionSeparator />

## Container Image Deployment

Lambda functions deployed as container images do not support Lambda Layers in the traditional way. When using container images, you cannot attach a layer as you would with other Lambda deployment methods. Instead, you must manually incorporate the layerâ€™s contents into your container image during the build process.

For detailed container integration examples for Java, Node.js, Python, and .NET, refer to the [AWS documentation](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch-Application-Signals-Enable-LambdaMain.html#containerized-lambda).

<SectionSeparator />

## Monitor Application Health

**[Recommended]** Once you have enabled Application Signals on your Lambda functions, you can monitor your application health through the CloudWatch Application Signals console. This provides:

- **Service Maps** - Visual representation of your application architecture
- **Traces** - Detailed request flow and performance metrics
- **Metrics** - Standard application metrics and custom metrics
- **Alarms** - Automated alerts based on performance thresholds

For more information, see [Monitor the operational health of your applications with Application Signals](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/Services.html).

<SectionSeparator />

## (Not Recommended) Using the legacy ADOT Lambda Layers with embedded collector

<WarningBox
  warningText="The links below describes the legacy approach of using non-optimized ADOT Lambda Layer with an added overhead of a collector. Unless you want to export the telemetry data to a non CloudWatch endpoint, the approach below is not recommended"
/>

* [[Not Recommended] AWS managed Lambda layer for ADOT Java SDK and ADOT Collector](/docs/getting-started/lambda/lambda-java)
* [[Not Recommended] AWS managed Lambda Layer for ADOT Java Auto-instrumentation Agent and ADOT Collector](/docs/getting-started/lambda/lambda-java-auto-instr)
* [[Not Recommended] AWS managed Lambda Layer for ADOT JavaScript SDK and ADOT Collector](/docs/getting-started/lambda/lambda-js)
* [[Not Recommended] AWS managed Lambda Layer for ADOT Python SDK and ADOT Collector](/docs/getting-started/lambda/lambda-python)
* [[Not Recommended] AWS managed Lambda Layer for ADOT Collector and ADOT Lambda .NET SDK (Manual Instrumentation)](/docs/getting-started/lambda/lambda-dotnet)
* [[Not Recommended] AWS managed Lambda Layer for ADOT Collector and ADOT Lambda Go SDK (Manual Instrumentation)](/docs/getting-started/lambda/lambda-go)

### Advanced Configurations
* [Manual Steps for Private Lambda Layers](/docs/getting-started/lambda/lambda-manual-steps) - Instructions for building and deploying custom Lambda layers
* [Custom Configuration for ADOT Collector on Lambda](/docs/getting-started/lambda/lambda-custom-configuration) - Detailed guide for customizing the ADOT Collector configuration



