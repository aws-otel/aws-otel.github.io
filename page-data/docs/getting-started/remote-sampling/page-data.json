{
    "componentChunkName": "component---node-modules-rocketseat-gatsby-theme-docs-core-src-templates-docs-query-js",
    "path": "/docs/getting-started/remote-sampling",
    "result": {"data":{"mdx":{"id":"59577186-0e78-5bae-8f9a-e37c8395662c","excerpt":"Enable awsproxy extension Note that in order to use X-Ray remote sampling, your application's tracer must use an X-Ray sampler. Today the X-Ray sampler isâ€¦","fields":{"slug":"/docs/getting-started/remote-sampling/"},"frontmatter":{"title":"Configuring the OpenTelemetry Collector for X-Ray remote Sampling","description":"This page is about setting up X-Ray remote Sampling.","image":null,"disableTableOfContents":null},"body":"var _excluded = [\"components\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"title\": \"Configuring the OpenTelemetry Collector for X-Ray remote Sampling\",\n  \"description\": \"This page is about setting up X-Ray remote Sampling.\",\n  \"path\": \"/docs/getting-started/remote-sampling\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", {\n    \"id\": \"enable-awsproxy-extension\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#enable-awsproxy-extension\",\n    \"aria-label\": \"enable awsproxy extension permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Enable awsproxy extension\"), mdx(\"p\", null, \"Note that in order to use X-Ray remote sampling, your application's tracer must use an X-Ray sampler. Today the X-Ray sampler is available for the following:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://aws-otel.github.io/docs/getting-started/java-sdk/trace-auto-instr#using-x-ray-remote-sampling\"\n  }, \"ADOT Java auto-instrumentation agent\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://aws-otel.github.io/docs/getting-started/java-sdk/trace-manual-instr#using-x-ray-remote-sampling\"\n  }, \"ADOT Java SDK\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://aws-otel.github.io/docs/getting-started/go-sdk/trace-manual-instr#using-x-ray-remote-sampling\"\n  }, \"ADOT Go SDK\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://aws-otel.github.io/docs/getting-started/python-sdk/auto-instr#using-aws-x-ray-remote-sampling\"\n  }, \"ADOT Python auto-instrumentation agent\"))), mdx(\"p\", null, \"Enable the extension by adding this snippet to your collector configuration.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yaml\"\n  }, \"extensions:\\n  awsproxy:\\nservice:\\n  extensions: [awsproxy]\\n\")), mdx(\"p\", null, \"For example, a full configuration that receives spans as OTLP, exports to X-Ray, and enables remote sampling may\\nlook like this.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yaml\"\n  }, \"receivers:\\n  otlp:\\n    protocols:\\n      grpc:\\nexporters:\\n  awsxray:\\nextensions:\\n  awsproxy:\\nservice:\\n  extensions: [awsproxy]\\n  pipeline:\\n    traces:\\n      receivers: [otlp]\\n      exporters: [awsxray]\\n\")), mdx(\"p\", null, \"This enables the proxy listening on the default endpoint of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"0.0.0.0:2000\"), \" - SDK sampling extensions for X-Ray remote\\nsampling connect to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"localhost:2000\"), \" by default and will work out of the box when deploying the collector as a sidecar.\"), mdx(\"p\", null, \"The full list of configuration options can be found in the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/extension/awsproxy\"\n  }, \"component documentation\"), \".\"), mdx(\"p\", null, \"Once you have enabled the proxy extension and configured the remote sampler in your application, you can follow the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.aws.amazon.com/xray/latest/devguide/xray-console-sampling.html\"\n  }, \"AWS X-Ray documentation\"), \" to define custom sampling rules for incoming requests and see them applied across your entire fleet.\"), mdx(\"p\", null, \"The IAM policy used with the collector also needs permission to fetch sampling rules. This policy would allow the collector\\nto export trace data and fetch sampling rules.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"{\\n    \\\"Version\\\": \\\"2012-10-17\\\",\\n    \\\"Statement\\\": [\\n        {\\n            \\\"Effect\\\": \\\"Allow\\\",\\n            \\\"Action\\\": [\\n                \\\"xray:PutTraceSegments\\\",\\n                \\\"xray:PutTelemetryRecords\\\",\\n                \\\"xray:GetSamplingRules\\\",\\n                \\\"xray:GetSamplingTargets\\\",\\n                \\\"xray:GetSamplingStatisticSummaries\\\"\\n            ],\\n            \\\"Resource\\\": \\\"*\\\"\\n        }\\n    ]\\n}\\n\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Warning: The proxy extension allows any application with network connectivity to the collector to send requests to X-Ray\\nwithout authentication. If not using any other authentication mechanism in front of the collector, it is recommended to\\nconfigure network policy to only allow network connectivity to applications that should be allowed to access X-Ray with\\nthe above IAM permissions, for example using network firewall rules.\")), mdx(\"h2\", {\n    \"id\": \"otel-remote-sampling-implementation-caveats\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#otel-remote-sampling-implementation-caveats\",\n    \"aria-label\": \"otel remote sampling implementation caveats permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"OTel Remote Sampling Implementation Caveats\"), mdx(\"p\", null, \"To note that X-Ray Sampling attributes can be configured from AWS X-Ray Console shown in below image.\"), mdx(\"img\", {\n    src: sampling_attributes,\n    alt: \"Diagram\",\n    style: {\n      \"margin\": \"30px 0\"\n    }\n  }), mdx(\"p\", null, \"Below mentioned table displays X-Ray sampling attributes and X-Ray equivalent OTel sampling attributes used by the OTel remote sampling implementation. Here's how you can \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.aws.amazon.com/xray/latest/devguide/xray-console-sampling.html#xray-console-config\"\n  }, \"configure X-Ray sampling attributes\"), \" in AWS X-Ray Console. Below mentioned caveats to keep in mind when using OTel remote sampling implementation.\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Some of the X-Ray equivalent OTel sampling fields are instrumentation specific like \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"http.target\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"http.url\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"http.method\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"http.host\"), \". If instrumentation you're using in your application won't set them then remote sampling implementation would not have all these fields to match against in that case it would only use resource attributes like \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"service.name\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"cloud.platform\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Sampling implementation would match \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"URLPath\"), \" (X-Ray sampling attribute set on AWS X-Ray Console) with \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"http.target\"), \" as well as \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"http.url\"), \" and if it finds a match with one of them it would consider matched\")), mdx(\"table\", null, mdx(\"thead\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"thead\"\n  }, mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"X-Ray Sampling Attributes\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"X-Ray equivalent OTel Sampling Semantic Attributes\"))), mdx(\"tbody\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"ServiceName\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"service.name\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"ServiceType\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"cloud.platform\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"URLPath\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"http.target/http.url\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Host\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"http.host\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"HTTPMethod\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"http.method\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Attributes\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"attributes\")))));\n}\n;\nMDXContent.isMDXComponent = true;","headings":[{"depth":2,"value":"Enable awsproxy extension"},{"depth":2,"value":"OTel Remote Sampling Implementation Caveats"}]}},"pageContext":{"slug":"/docs/getting-started/remote-sampling/","repositoryEditUrl":"https://github.com/rocketseat/gatsby-themes/tree/main/examples/gatsby-theme-docs/src/docs/getting-started/remote-sampling.mdx","repositoryProvider":"GitHub"}},
    "staticQueryHashes": ["2501019404","973074209"]}